<!-- Version: 1.0056 -->
<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCY1 Token - Admin Interface</title>
    <link rel="stylesheet" href="/shared/css/common.css">
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .wallet-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .wallet-info p {
            margin: 5px 0;
            font-family: 'Courier New', monospace;
        }

        .connect-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .connect-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h2::before {
            content: 'üîπ';
            font-size: 0.8em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 100px;
            font-family: 'Courier New', monospace;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #28a745;
        }

        .btn-danger {
            background: #dc3545;
        }

        .status-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .status-box pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            background: #e0e0e0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab:hover {
            background: #764ba2;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .info-badge {
            display: inline-block;
            padding: 5px 10px;
            background: #667eea;
            color: white;
            border-radius: 5px;
            font-size: 0.9em;
            margin-right: 10px;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .sections {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîê KCY1 Token Admin Interface</h1>
            <p style="color: #666; margin-top: 10px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ KCY-meme-1 —Ç–æ–∫–µ–Ω —á—Ä–µ–∑ Web3</p>
            
            <button class="connect-btn" id="connectBtn" onclick="connectWallet()">
                Connect Wallet
            </button>

            <div class="wallet-info" id="walletInfo" style="display: none;">
                <p><strong>Connected:</strong> <span id="walletAddress"></span></p>
                <p><strong>Network:</strong> <span id="networkName"></span></p>
                <p><strong>Token Address:</strong> <span id="tokenAddress"></span></p>
            </div>

            <div class="alert alert-warning" style="margin-top: 20px;">
                <strong>‚ö†Ô∏è –í–ê–ñ–ù–û:</strong> –°–≤—ä—Ä–∂–∏ Ledger/Trezor —á—Ä–µ–∑ MetaMask –∏–ª–∏ –∏–∑–ø–æ–ª–∑–≤–∞–π MetaMask –¥–∏—Ä–µ–∫—Ç–Ω–æ. 
                –í—Å–∏—á–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑–∏—Å–∫–≤–∞—Ç –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞ wallet-–∞.
            </div>
        </div>

        <!-- Main Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('status')">üìä Status</button>
            <button class="tab" onclick="showTab('pause')">‚è∏Ô∏è Pause</button>
            <button class="tab" onclick="showTab('blacklist')">üö´ Blacklist</button>
            <button class="tab" onclick="showTab('slots')">üîß Exempt Slots</button>
            <button class="tab" onclick="showTab('liquidity')">üíß Liquidity</button>
            <button class="tab" onclick="showTab('mint')">üå± Mint</button>
            <button class="tab" onclick="showTab('tokens')">üî• Token Ops</button>
        </div>

        <!-- Tab Contents -->
        <div class="sections">
            <!-- STATUS TAB -->
            <div class="tab-content active" id="status-tab">
                <div class="section">
                    <h2>Status Check</h2>
                    <p style="color: #666; margin-bottom: 20px;">–ü—Ä–æ–≤–µ—Ä–∏ —Ç–µ–∫—É—â–∏—è —Å—Ç–∞—Ç—É—Å –Ω–∞ —Ç–æ–∫–µ–Ω–∞</p>
                    
                    <button class="btn" onclick="checkStatus()">üîç Check Status</button>
                    
                    <div class="status-box" id="statusOutput"></div>
                </div>
            </div>

            <!-- PAUSE TAB -->
            <div class="tab-content" id="pause-tab">
                <div class="section">
                    <h2>Pause Control</h2>
                    <p style="color: #666; margin-bottom: 20px;">–ü–∞—É–∑–∞ –Ω–∞ trading –∑–∞ 48 —á–∞—Å–∞</p>
                    
                    <div class="alert alert-info">
                        <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong><br>
                        ‚Ä¢ Normal users –ù–ï –º–æ–≥–∞—Ç –¥–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∏—Ä–∞—Ç<br>
                        ‚Ä¢ Exempt –∞–¥—Ä–µ—Å–∏ –ú–û–ì–ê–¢ –¥–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∏—Ä–∞—Ç<br>
                        ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–µ –æ—Ç–ø–∞—É–∑–≤–∞ —Å–ª–µ–¥ 48h
                    </div>

                    <button class="btn btn-danger" onclick="pauseTrading()">‚è∏Ô∏è Pause Trading (48h)</button>
                    
                    <div class="status-box" id="pauseOutput"></div>
                </div>
            </div>

            <!-- BLACKLIST TAB -->
            <div class="tab-content" id="blacklist-tab">
                <div class="section">
                    <h2>Blacklist Management</h2>
                    
                    <div class="form-group">
                        <label>Address –∑–∞ blacklist:</label>
                        <input type="text" id="blacklistAddress" placeholder="0x...">
                    </div>

                    <button class="btn" onclick="addToBlacklist()">üö´ Add to Blacklist</button>
                    <button class="btn btn-secondary" onclick="checkBlacklist()">üîç Check Address</button>
                    
                    <div class="alert alert-warning" style="margin-top: 20px;">
                        <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:</strong> –°–∞–º–æ Multi-Sig –º–æ–∂–µ –¥–∞ –ø—Ä–µ–º–∞—Ö–≤–∞ –æ—Ç blacklist!
                    </div>

                    <div class="status-box" id="blacklistOutput"></div>
                </div>
            </div>

            <!-- EXEMPT SLOTS TAB -->
            <div class="tab-content" id="slots-tab">
                <div class="section">
                    <h2>Exempt Slots Management</h2>
                    
                    <div class="form-group">
                        <label>Slot Number (1-10):</label>
                        <select id="slotNumber">
                            <option value="">-- –ò–∑–±–µ—Ä–∏ Slot --</option>
                            <option value="1" disabled>Slot 1 (Owner - locked)</option>
                            <option value="2">Slot 2 (Multi-Sig only)</option>
                            <option value="3">Slot 3 (Multi-Sig only)</option>
                            <option value="4">Slot 4 (Multi-Sig only)</option>
                            <option value="5">Slot 5 (Multi-Sig only)</option>
                            <option value="6">Slot 6 (Admin)</option>
                            <option value="7">Slot 7 (Admin)</option>
                            <option value="8">Slot 8 (Admin)</option>
                            <option value="9">Slot 9 (Admin)</option>
                            <option value="10">Slot 10 (Admin)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–ù–æ–≤ Address:</label>
                        <input type="text" id="newSlotAddress" placeholder="0x...">
                    </div>

                    <div class="alert alert-info">
                        <strong>‚ÑπÔ∏è Slot Rules:</strong><br>
                        ‚Ä¢ Slot 1: Owner (–ù–ï –º–æ–∂–µ –¥–∞ —Å–µ –ø—Ä–æ–º–µ–Ω—è)<br>
                        ‚Ä¢ Slots 2-5: –°–∞–º–æ Multi-Sig<br>
                        ‚Ä¢ Slots 6-10: –í—Å–µ–∫–∏ Admin<br>
                        ‚Ä¢ ‚ö†Ô∏è Auto-pause 48h —Å–ª–µ–¥ –ø—Ä–æ–º—è–Ω–∞!
                    </div>

                    <button class="btn" onclick="updateExemptSlot()">üîß Update Slot</button>
                    <button class="btn btn-secondary" onclick="viewExemptSlots()">üëÅÔ∏è View All Slots</button>
                    <button class="btn btn-danger" onclick="lockExemptSlots()">üîí Lock Forever</button>
                    
                    <div class="status-box" id="slotsOutput"></div>
                </div>
            </div>

            <!-- LIQUIDITY TAB -->
            <div class="tab-content" id="liquidity-tab">
                <div class="section">
                    <h2>Liquidity Pairs Management</h2>
                    
                    <div class="form-group">
                        <label>Pair Address:</label>
                        <input type="text" id="pairAddress" placeholder="0x...">
                    </div>

                    <button class="btn" onclick="addLiquidityPair()">‚ûï Add Pair</button>
                    <button class="btn btn-secondary" onclick="findPair()">üîç Find KCY1/WBNB Pair</button>
                    <button class="btn btn-danger" onclick="lockLiquidityPairs()">üîí Lock Forever</button>
                    
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <strong>‚ÑπÔ∏è Workflow:</strong><br>
                        1. –î–æ–±–∞–≤–∏ liquidity –≤ PancakeSwap<br>
                        2. –ù–∞—Ç–∏—Å–Ω–∏ "Find Pair" –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–º–∏—Ä–∞–Ω–µ<br>
                        3. –ù–∞—Ç–∏—Å–Ω–∏ "Add Pair" –∑–∞ exempt —Å—Ç–∞—Ç—É—Å
                    </div>

                    <div class="status-box" id="liquidityOutput"></div>
                </div>
            </div>

            <!-- MINT TAB -->
            <div class="tab-content" id="mint-tab">
                <div class="section">
                    <h2>Mint Operations</h2>
                    
                    <div class="form-group">
                        <label>Amount (—Ç–æ–∫–µ–Ω–∏):</label>
                        <input type="number" id="mintAmount" placeholder="1000000" value="1000000">
                        <small style="color: #666;">Max: 5,000,000 —Ç–æ–∫–µ–Ω–∞</small>
                    </div>

                    <button class="btn" onclick="proposeMint()">üå± Propose Mint</button>
                    
                    <div class="form-group" style="margin-top: 30px;">
                        <label>Proposal ID (–∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ):</label>
                        <input type="number" id="proposalId" placeholder="0" value="0">
                    </div>

                    <button class="btn btn-secondary" onclick="executeMint()">‚úÖ Execute Mint</button>
                    <button class="btn" onclick="viewProposals()">üëÅÔ∏è View Proposals</button>
                    
                    <div class="alert alert-warning" style="margin-top: 20px;">
                        <strong>‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–∞:</strong><br>
                        ‚Ä¢ Timelock: 1 –¥–µ–Ω –ø—Ä–µ–¥–∏ execute<br>
                        ‚Ä¢ Cooldown: 1 —Å–µ–¥–º–∏—Ü–∞ –º–µ–∂–¥—É mints<br>
                        ‚Ä¢ Max: 5M —Ç–æ–∫–µ–Ω–∞ –Ω–∞ mint
                    </div>

                    <div class="status-box" id="mintOutput"></div>
                </div>
            </div>

            <!-- TOKEN OPS TAB -->
            <div class="tab-content" id="tokens-tab">
                <div class="section">
                    <h2>Token Operations</h2>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="showSubTab('burn')">üî• Burn</button>
                        <button class="tab" onclick="showSubTab('withdraw')">üì§ Withdraw</button>
                        <button class="tab" onclick="showSubTab('bnb')">üíé BNB</button>
                        <button class="tab" onclick="showSubTab('rescue')">üö® Rescue</button>
                    </div>

                    <!-- Burn Sub-tab -->
                    <div class="tab-content active" id="burn-subtab">
                        <div class="form-group">
                            <label>Amount –∑–∞ burn:</label>
                            <input type="number" id="burnAmount" placeholder="100000">
                        </div>
                        <button class="btn btn-danger" onclick="burnTokens()">üî• Burn Tokens</button>
                        <div class="alert alert-danger" style="margin-top: 15px;">
                            <strong>‚ö†Ô∏è –ù–ï–û–ë–†–ê–¢–ò–ú–û!</strong> Total Supply –Ω–∞–º–∞–ª—è–≤–∞!
                        </div>
                    </div>

                    <!-- Withdraw Sub-tab -->
                    <div class="tab-content" id="withdraw-subtab">
                        <div class="form-group">
                            <label>Amount –∑–∞ withdraw –æ—Ç contract:</label>
                            <input type="number" id="withdrawAmount" placeholder="50000">
                        </div>
                        <button class="btn" onclick="withdrawTokens()">üì§ Withdraw Tokens</button>
                    </div>

                    <!-- BNB Sub-tab -->
                    <div class="tab-content" id="bnb-subtab">
                        <p style="margin-bottom: 20px;">Withdraw –≤—Å–∏—á–∫–∏ BNB –æ—Ç contract</p>
                        <button class="btn" onclick="withdrawBNB()">üíé Withdraw BNB</button>
                    </div>

                    <!-- Rescue Sub-tab -->
                    <div class="tab-content" id="rescue-subtab">
                        <div class="form-group">
                            <label>Token Address:</label>
                            <input type="text" id="rescueTokenAddress" placeholder="0x...">
                        </div>
                        <div class="form-group">
                            <label>Amount:</label>
                            <input type="number" id="rescueAmount" placeholder="1000">
                        </div>
                        <button class="btn" onclick="rescueTokens()">üö® Rescue Tokens</button>
                    </div>

                    <div class="status-box" id="tokenOpsOutput"></div>
                </div>
            </div>
        </div>

        <!-- Config Section -->
        <div class="section" style="margin-top: 30px;">
            <h2>Configuration</h2>
            <div class="form-group">
                <label>Token Contract Address:</label>
                <input type="text" id="configTokenAddress" value="0xadresnatokena" placeholder="0x...">
                <button class="btn" onclick="updateConfig()" style="margin-top: 10px;">üíæ Save Config</button>
            </div>

            <div class="alert alert-info" style="margin-top: 20px;">
                <strong>üìö –ó–∞ Hardhat —Å–∫—Ä–∏–ø—Ç–æ–≤–µ—Ç–µ:</strong><br>
                –°–∫—Ä–∏–ø—Ç–æ–≤–µ—Ç–µ —Å–∞ –≤ <code>admin/scripts/</code> –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ç–∞.<br>
                –ò–∑–ø—ä–ª–Ω—è–≤–∞–π –≥–∏ —Å: <code>npx hardhat run admin/scripts/XX-script.js --network bscMainnet</code>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let web3;
        let contract;
        let userAddress;
        const TOKEN_ADDRESS = "0xadresnatokena";
        
        // Simplified ABI - —Å–∞–º–æ –Ω—É–∂–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏
        const TOKEN_ABI = [
            {"inputs":[],"name":"pause","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"bool","name":"status","type":"bool"}],"name":"setBlacklist","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isBlacklisted","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint8","name":"slotIndex","type":"uint8"},{"internalType":"address","name":"newAddress","type":"address"}],"name":"updateExemptSlot","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"address","name":"pair","type":"address"},{"internalType":"bool","name":"status","type":"bool"}],"name":"setLiquidityPair","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"proposeMint","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"proposalId","type":"uint256"}],"name":"executeMint","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdrawCirculationTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"withdrawBNB","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"address","name":"tokenAddress","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"rescueTokens","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"lockExemptSlotsForever","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"lockLiquidityPairsForever","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr1","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr2","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr3","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr4","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr5","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr6","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr7","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr8","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr9","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"eAddr10","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"exemptSlotsLocked","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"liquidityPairsLocked","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"NotExemptTradeTransferPausedUntil","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"proposalCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"mintProposals","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"proposedAt","type":"uint256"},{"internalType":"uint256","name":"executeAfter","type":"uint256"},{"internalType":"bool","name":"executed","type":"bool"}],"stateMutability":"view","type":"function"}
        ];

        // Connect Wallet
        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('MetaMask –Ω–µ –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω! –ú–æ–ª—è –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–π MetaMask.');
                    return;
                }

                await window.ethereum.request({ method: 'eth_requestAccounts' });
                web3 = new Web3(window.ethereum);
                
                const accounts = await web3.eth.getAccounts();
                userAddress = accounts[0];
                
                const chainId = await web3.eth.getChainId();
                const networkName = chainId === 56 ? 'BSC Mainnet' : chainId === 97 ? 'BSC Testnet' : `Unknown (${chainId})`;
                
                document.getElementById('walletAddress').textContent = userAddress;
                document.getElementById('networkName').textContent = networkName;
                document.getElementById('tokenAddress').textContent = document.getElementById('configTokenAddress').value;
                document.getElementById('walletInfo').style.display = 'block';
                document.getElementById('connectBtn').textContent = 'Connected ‚úÖ';
                document.getElementById('connectBtn').disabled = true;
                
                const tokenAddr = document.getElementById('configTokenAddress').value;
                contract = new web3.eth.Contract(TOKEN_ABI, tokenAddr);
                
                logOutput('statusOutput', '‚úÖ Wallet connected successfully!');
            } catch (error) {
                alert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ —Å–≤—ä—Ä–∑–≤–∞–Ω–µ: ' + error.message);
            }
        }

        // Helper functions
        function logOutput(elementId, message) {
            const output = document.getElementById(elementId);
            output.innerHTML = `<pre>${message}</pre>`;
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function showSubTab(tabName) {
            document.querySelectorAll('#tokens-tab .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#tokens-tab .tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName + '-subtab').classList.add('active');
        }

        function updateConfig() {
            const newAddr = document.getElementById('configTokenAddress').value;
            contract = new web3.eth.Contract(TOKEN_ABI, newAddr);
            document.getElementById('tokenAddress').textContent = newAddr;
            alert('Config updated! Reload page to reconnect.');
        }

        // Check Status
        async function checkStatus() {
            if (!contract) { alert('Connect wallet first!'); return; }
            
            try {
                logOutput('statusOutput', '‚è≥ Loading...');
                
                const owner = await contract.methods.owner().call();
                const totalSupply = await contract.methods.totalSupply().call();
                const balance = await contract.methods.balanceOf(userAddress).call();
                const pausedUntil = await contract.methods.NotExemptTradeTransferPausedUntil().call();
                const slotsLocked = await contract.methods.exemptSlotsLocked().call();
                const pairsLocked = await contract.methods.liquidityPairsLocked().call();
                
                const now = Math.floor(Date.now() / 1000);
                const isPaused = pausedUntil > now;
                
                let output = 'üìä TOKEN STATUS\n';
                output += '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
                output += `Owner: ${owner}\n`;
                output += `Total Supply: ${web3.utils.fromWei(totalSupply, 'ether')} tokens\n`;
                output += `Your Balance: ${web3.utils.fromWei(balance, 'ether')} tokens\n`;
                output += `\nüîí LOCKS:\n`;
                output += `Trading: ${isPaused ? '‚è∏Ô∏è PAUSED' : '‚ñ∂Ô∏è Active'}\n`;
                output += `Exempt Slots: ${slotsLocked ? 'üîí LOCKED' : 'üîì Unlocked'}\n`;
                output += `Liquidity Pairs: ${pairsLocked ? 'üîí LOCKED' : 'üîì Unlocked'}\n`;
                
                logOutput('statusOutput', output);
            } catch (error) {
                logOutput('statusOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Pause Trading
        async function pauseTrading() {
            if (!contract) { alert('Connect wallet first!'); return; }
            if (!confirm('–ü–∞—É–∑–≤–∞ trading –∑–∞ 48 —á–∞—Å–∞. –°–∏–≥—É—Ä–µ–Ω –ª–∏ —Å–∏?')) return;
            
            try {
                logOutput('pauseOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.pause().send({ from: userAddress });
                logOutput('pauseOutput', `‚úÖ Success!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('pauseOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Blacklist functions
        async function addToBlacklist() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const addr = document.getElementById('blacklistAddress').value;
            if (!addr) { alert('–í—ä–≤–µ–¥–∏ address!'); return; }
            if (!confirm(`Add ${addr} to blacklist?`)) return;
            
            try {
                logOutput('blacklistOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.setBlacklist(addr, true).send({ from: userAddress });
                logOutput('blacklistOutput', `‚úÖ Success!\nAddress blacklisted!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('blacklistOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function checkBlacklist() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const addr = document.getElementById('blacklistAddress').value;
            if (!addr) { alert('–í—ä–≤–µ–¥–∏ address!'); return; }
            
            try {
                const isBlacklisted = await contract.methods.isBlacklisted(addr).call();
                logOutput('blacklistOutput', `Address: ${addr}\nStatus: ${isBlacklisted ? 'üö´ BLACKLISTED' : '‚úÖ Not blacklisted'}`);
            } catch (error) {
                logOutput('blacklistOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Exempt Slots functions
        async function updateExemptSlot() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const slot = document.getElementById('slotNumber').value;
            const addr = document.getElementById('newSlotAddress').value;
            if (!slot || !addr) { alert('–ü–æ–ø—ä–ª–Ω–∏ slot –∏ address!'); return; }
            if (!confirm(`Update Slot ${slot} to ${addr}?\n‚ö†Ô∏è Trading —â–µ —Å–µ –ø–∞—É–∑–Ω–µ –∑–∞ 48h!`)) return;
            
            try {
                logOutput('slotsOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.updateExemptSlot(slot, addr).send({ from: userAddress });
                logOutput('slotsOutput', `‚úÖ Success!\nSlot ${slot} updated!\n‚è∏Ô∏è Trading paused 48h\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('slotsOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function viewExemptSlots() {
            if (!contract) { alert('Connect wallet first!'); return; }
            
            try {
                logOutput('slotsOutput', '‚è≥ Loading...');
                let output = 'üîß EXEMPT SLOTS\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
                
                for (let i = 1; i <= 10; i++) {
                    const addr = await contract.methods[`eAddr${i}`]().call();
                    const isYou = addr.toLowerCase() === userAddress.toLowerCase();
                    output += `Slot ${i}: ${addr}${isYou ? ' ‚úÖ (YOU)' : ''}\n`;
                }
                
                logOutput('slotsOutput', output);
            } catch (error) {
                logOutput('slotsOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function lockExemptSlots() {
            if (!contract) { alert('Connect wallet first!'); return; }
            if (!confirm('‚ö†Ô∏è –ù–ï–û–ë–†–ê–¢–ò–ú–û! Lock exempt slots –ó–ê–í–ò–ù–ê–ì–ò?')) return;
            
            try {
                logOutput('slotsOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.lockExemptSlotsForever().send({ from: userAddress });
                logOutput('slotsOutput', `‚úÖ Success!\nüîí Exempt slots LOCKED FOREVER!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('slotsOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Liquidity functions
        async function addLiquidityPair() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const pair = document.getElementById('pairAddress').value;
            if (!pair) { alert('–í—ä–≤–µ–¥–∏ pair address!'); return; }
            if (!confirm(`Add ${pair} as liquidity pair?`)) return;
            
            try {
                logOutput('liquidityOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.setLiquidityPair(pair, true).send({ from: userAddress });
                logOutput('liquidityOutput', `‚úÖ Success!\nPair added as exempt!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('liquidityOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function findPair() {
            if (!web3) { alert('Connect wallet first!'); return; }
            
            try {
                logOutput('liquidityOutput', '‚è≥ Searching for pair...');
                
                const factoryABI = [{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"}],"name":"getPair","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"}];
                const factoryAddr = '0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73'; // BSC Mainnet
                const wbnbAddr = '0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c';
                const tokenAddr = document.getElementById('configTokenAddress').value;
                
                const factory = new web3.eth.Contract(factoryABI, factoryAddr);
                const pair = await factory.methods.getPair(tokenAddr, wbnbAddr).call();
                
                if (pair === '0x0000000000000000000000000000000000000000') {
                    logOutput('liquidityOutput', '‚ùå Pair not found!\n–î–æ–±–∞–≤–∏ liquidity –≤ PancakeSwap –ø—ä—Ä–≤–æ.');
                } else {
                    document.getElementById('pairAddress').value = pair;
                    logOutput('liquidityOutput', `‚úÖ Pair found!\nAddress: ${pair}\n\n–°–µ–≥–∞ –Ω–∞—Ç–∏—Å–Ω–∏ "Add Pair" –∑–∞ exempt —Å—Ç–∞—Ç—É—Å.`);
                }
            } catch (error) {
                logOutput('liquidityOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function lockLiquidityPairs() {
            if (!contract) { alert('Connect wallet first!'); return; }
            if (!confirm('‚ö†Ô∏è –ù–ï–û–ë–†–ê–¢–ò–ú–û! Lock liquidity pairs –ó–ê–í–ò–ù–ê–ì–ò?')) return;
            
            try {
                logOutput('liquidityOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.lockLiquidityPairsForever().send({ from: userAddress });
                logOutput('liquidityOutput', `‚úÖ Success!\nüîí Liquidity pairs LOCKED FOREVER!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('liquidityOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Mint functions
        async function proposeMint() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const amount = document.getElementById('mintAmount').value;
            if (!amount) { alert('–í—ä–≤–µ–¥–∏ amount!'); return; }
            if (!confirm(`Propose mint of ${amount} tokens?\nTimelock: 1 –¥–µ–Ω`)) return;
            
            try {
                logOutput('mintOutput', '‚è≥ Sending transaction...');
                const amountWei = web3.utils.toWei(amount, 'ether');
                const tx = await contract.methods.proposeMint(amountWei).send({ from: userAddress });
                logOutput('mintOutput', `‚úÖ Success!\nMint proposed!\n‚è∞ Wait 1 day to execute\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('mintOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function executeMint() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const proposalId = document.getElementById('proposalId').value;
            if (!confirm(`Execute mint proposal ${proposalId}?`)) return;
            
            try {
                logOutput('mintOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.executeMint(proposalId).send({ from: userAddress });
                logOutput('mintOutput', `‚úÖ Success!\nMint executed!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('mintOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function viewProposals() {
            if (!contract) { alert('Connect wallet first!'); return; }
            
            try {
                logOutput('mintOutput', '‚è≥ Loading...');
                const count = await contract.methods.proposalCount().call();
                
                if (count == 0) {
                    logOutput('mintOutput', '–ù—è–º–∞ proposals');
                    return;
                }
                
                let output = 'üå± MINT PROPOSALS\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n';
                
                for (let i = 0; i < count; i++) {
                    const proposal = await contract.methods.mintProposals(i).call();
                    const amount = web3.utils.fromWei(proposal.amount, 'ether');
                    const executed = proposal.executed;
                    output += `\nProposal ${i}:\n`;
                    output += `  Amount: ${amount} tokens\n`;
                    output += `  Status: ${executed ? '‚úÖ Executed' : '‚è≥ Pending'}\n`;
                }
                
                logOutput('mintOutput', output);
            } catch (error) {
                logOutput('mintOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Token operations
        async function burnTokens() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const amount = document.getElementById('burnAmount').value;
            if (!amount) { alert('–í—ä–≤–µ–¥–∏ amount!'); return; }
            if (!confirm(`üî• BURN ${amount} tokens?\n‚ö†Ô∏è –ù–ï–û–ë–†–ê–¢–ò–ú–û!`)) return;
            
            try {
                logOutput('tokenOpsOutput', '‚è≥ Sending transaction...');
                const amountWei = web3.utils.toWei(amount, 'ether');
                const tx = await contract.methods.burn(amountWei).send({ from: userAddress });
                logOutput('tokenOpsOutput', `‚úÖ Success!\nüî• ${amount} tokens burned!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('tokenOpsOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function withdrawTokens() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const amount = document.getElementById('withdrawAmount').value;
            if (!amount) { alert('–í—ä–≤–µ–¥–∏ amount!'); return; }
            if (!confirm(`Withdraw ${amount} tokens –æ—Ç contract?`)) return;
            
            try {
                logOutput('tokenOpsOutput', '‚è≥ Sending transaction...');
                const amountWei = web3.utils.toWei(amount, 'ether');
                const tx = await contract.methods.withdrawCirculationTokens(amountWei).send({ from: userAddress });
                logOutput('tokenOpsOutput', `‚úÖ Success!\nüì§ ${amount} tokens withdrawn!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('tokenOpsOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function withdrawBNB() {
            if (!contract) { alert('Connect wallet first!'); return; }
            if (!confirm('Withdraw –≤—Å–∏—á–∫–∏ BNB –æ—Ç contract?')) return;
            
            try {
                logOutput('tokenOpsOutput', '‚è≥ Sending transaction...');
                const tx = await contract.methods.withdrawBNB().send({ from: userAddress });
                logOutput('tokenOpsOutput', `‚úÖ Success!\nüíé BNB withdrawn!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('tokenOpsOutput', '‚ùå Error: ' + error.message);
            }
        }

        async function rescueTokens() {
            if (!contract) { alert('Connect wallet first!'); return; }
            const tokenAddr = document.getElementById('rescueTokenAddress').value;
            const amount = document.getElementById('rescueAmount').value;
            if (!tokenAddr || !amount) { alert('–ü–æ–ø—ä–ª–Ω–∏ –≤—Å–∏—á–∫–∏ –ø–æ–ª–µ—Ç–∞!'); return; }
            if (!confirm(`Rescue ${amount} tokens –æ—Ç ${tokenAddr}?`)) return;
            
            try {
                logOutput('tokenOpsOutput', '‚è≥ Sending transaction...');
                const amountWei = web3.utils.toWei(amount, 'ether');
                const tx = await contract.methods.rescueTokens(tokenAddr, amountWei).send({ from: userAddress });
                logOutput('tokenOpsOutput', `‚úÖ Success!\nüö® Tokens rescued!\nTx Hash: ${tx.transactionHash}`);
            } catch (error) {
                logOutput('tokenOpsOutput', '‚ùå Error: ' + error.message);
            }
        }

        // Auto-connect on load if previously connected
        window.addEventListener('load', async () => {
            if (typeof window.ethereum !== 'undefined') {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length > 0) {
                    connectWallet();
                }
            }
        });
    </script>
    <script src="/shared/js/navigation.js"></script>
</body>
</html>
